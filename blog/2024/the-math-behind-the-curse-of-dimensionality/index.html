<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h4>Dive into the “Curse of Dimensionality” concept and understand the math behind all the surprising phenomena that arise in high dimensions.</h4> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*-CoarMnxGCnELU9hYZcvtw.jpeg"><figcaption>Image from Dall-E</figcaption></figure> <p>In the realm of machine learning, handling high-dimensional vectors is not just common; it’s essential. This is illustrated by the architecture of popular models like Transformers. For instance, BERT uses 768-dimensional vectors to encode the tokens of the input sequences it processes and to better capture complex patterns in the data. Given that our brain struggles to visualize anything beyond 3 dimensions, the use of 768-dimensional vectors is quite mind-blowing!</p> <p>While some Machine and Deep Learning models excel in these high-dimensional scenarios, they also present many challenges. In this article, we will explore the concept of the “curse of dimensionality”, explain some interesting phenomena associated with it, delve into the mathematics behind these phenomena, and discuss their general implications for your Machine Learning models.</p> <p>Note that detailed mathematical proofs related to this article are <a href="https://www.maximewolf.com/blog/2024/The-Volume-of-the-nball/">available on my website</a> as a supplementary extension to this article.</p> <h3>What is the curse of dimensionality?</h3> <p>People often assume that geometric concepts familiar in three dimensions behave similarly in higher-dimensional spaces. <strong>This is not the case</strong>. As dimension increases, many interesting and counterintuitive phenomena arise. The “Curse of Dimensionality” is a term invented by Richard Bellman (famous mathematician) that refers to all these surprising effects.</p> <p>What is so special about high-dimension is how the “volume” of the space (we’ll explore that in more detail soon) is growing <strong>exponentially</strong>. Take a graduated line (in one dimension) from 1 to 10. There are 10 integers on this line. Extend that in 2 dimensions: it is now a square with 10 × 10 = 100 points with integer coordinates. Now consider “only” 80 dimensions: you would already have <strong>10⁸⁰ points</strong> which is the number of atoms in the universe.</p> <p>In other words, as the dimension increases, the volume of the space grows exponentially, resulting in data becoming <strong>increasingly sparse</strong>.</p> <blockquote>High-dimensional spaces are “empty”</blockquote> <p>Consider this other example. We want to calculate the farthest distance between two points in a unit hypercube (where each side has a length of 1):</p> <ul> <li>In <strong>1 dimension</strong> (the hypercube is a line segment from 0 to 1), the maximum distance is simply 1.</li> <li>In <strong>2 dimensions</strong> (the hypercube forms a square), the maximum distance is the distance between the opposite corners [0,0] and [1,1], which is √2, calculated using the Pythagorean theorem.</li> <li>Extending this concept to <strong>n dimensions</strong>, the distance between the points at [0,0,…,0] and [1,1,…,1] is √n. This formula arises because each additional dimension adds a square of 1 to the sum under the square root (again by the Pythagorean theorem).</li> </ul> <p>Interestingly, as the number of dimensions n increases, the largest distance within the hypercube grows at an O(√n) rate. This phenomenon illustrates a <strong>diminishing returns effect</strong>, where increases in dimensional space lead to proportionally smaller gains in spatial distance. More details on this effect and its implications will be explored in the following sections of this article.</p> <h3>The notion of distance in high dimensions</h3> <p>Let’s dive deeper into the notion of distances we started exploring in the previous section.</p> <p>We had our first glimpse of how high-dimensional spaces render the notion of distance almost <strong>meaningless</strong>. But what does this really mean, and can we mathematically visualize this phenomenon?</p> <p>Let’s consider an experiment, using the same n-dimensional unit hypercube we defined before. First, we generate a dataset by randomly sampling many points in this cube: we effectively simulate a multivariate uniform distribution. Then, we sample another point (a “query” point) from that distribution and observe the <strong>distance from its nearest and farthest neighbor in our dataset</strong>.</p> <p>Here is the corresponding Python code.</p> <pre>def generate_data(dimension, num_points):<br>    ''' Generate random data points within [0, 1] for each coordinate in the given dimension '''<br>    data = np.random.rand(num_points, dimension)<br>    return data<br><br><br>def neighbors(data, query_point):<br>    ''' Returns the nearest and farthest point in data from query_point '''<br>    nearest_distance = float('inf')<br>    farthest_distance = 0<br>    for point in data:<br>        distance = np.linalg.norm(point - query_point)<br>        if distance &lt; nearest_distance:<br>            nearest_distance = distance<br>        if distance &gt; farthest_distance:<br>            farthest_distance = distance<br>    return nearest_distance, farthest_distance</pre> <p>We can also plot these distances:</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/640/1*g0JgKAi0-dw_fyW9FRLaoQ.png"><figcaption>Distances to nearest and farthest points as n increases (Image by the author)</figcaption></figure> <p>Using a log scale, we observe that the <strong>relative</strong> difference between the distance to the nearest and farthest neighbor tends to decrease as the dimension increases.</p> <p>This is a very unintuitive behavior: as explained in the previous section, points are very sparse from each other because of the exponentially increasing volume of the space, but at the same time, the <strong>relative</strong> distances between points become smaller.</p> <blockquote>The notion of nearest neighbors vanishes</blockquote> <p>This means that the very concept of <strong>distance</strong> becomes less relevant and less discriminative as the dimension of the space increases. As you can imagine, it poses problems for Machine Learning algorithms that solely rely on distances such as kNN.</p> <h3>The maths: the n-ball</h3> <p>We will now talk about some other interesting phenomena. For this, we’ll need the <strong>n-ball</strong>. A n-ball is the generalization of a ball in n dimensions. The n-ball of radius R is the collection of points at a distance at most R from the center of the space 0.</p> <p>Let’s consider a radius of 1. The 1-ball is the segment [-1, 1]. The 2-ball is the disk delimited by the unit circle, whose equation is x² + y² ≤ 1. The 3-ball (what we normally call a “ball”) has the equation x² + y² + z² ≤ 1. As you understand, we can extend that definition to any dimension:</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/400/1*KVWjpsWBmsfv7dJtCjgfyA.png"></figure> <p>The question now is: what is the volume of this ball? This is not an easy question and requires quite a lot of maths, which I won’t detail here. However, you can find all the details on my website, in <a href="https://www.maximewolf.com/blog/2024/The-Volume-of-the-nball/">my post about the volume of the n-ball</a>.</p> <p>After a lot of fun (integral calculus), you can prove that the volume of the n-ball can be expressed as follows, where Γ denotes the <a href="https://en.wikipedia.org/wiki/Gamma_function" rel="external nofollow noopener" target="_blank">Gamma function</a>.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/283/1*vNIwC7a5oj_w3YsyCjfejg.png"></figure> <p>For example, with R = 1 and n = 2, the volume is πR², because Γ(2) = 1. This is indeed the “volume” of the 2-ball (also called the “area” of a circle in this case).</p> <p>However, beyond being an interesting mathematical challenge, the volume of the n-ball also has some very surprising properties.</p> <blockquote>As the dimension n increases, the volume of the n-ball converges to 0.</blockquote> <p>This is true for every radius, but let’s visualize this phenomenon with a few values of R.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/640/1*PKvuwKI8qlpTOy8Fd3qL1w.png"><figcaption>Volume of the n-ball for different radii as the dimension increases (Image by the author)</figcaption></figure> <p>As you can see, it only converges to 0, but it starts by increasing and then decreases to 0. For R = 1, the ball with the largest volume is the 5-ball, and the value of n that reaches the maximum shifts to the right as R increases.</p> <p>Here are the first values of the volume of the unit n-ball, up to n = 10.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/450/0*mf4mXZlsQ1pPljaH.jpg"><figcaption>Volume of the unit n-ball for different values of n (Image by the author)</figcaption></figure> <blockquote>The volume of a high-dimensional unit ball is concentrated near its surface.</blockquote> <p>For small dimensions, the volume of a ball looks quite “homogeneous”: this is not the case in high dimensions.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*9TMLQ3hyKMZgKWlb.png"><figcaption>A spherical shell</figcaption></figure> <p>Let’s consider an n-ball with radius R and another with radius R-dR where dR is very small. The portion of the n-ball between these 2 balls is called a “shell” and corresponds to the portion of the ball near its surface (see the visualization above in 3D). We can compute the ratio of the “inner” volume of the ball and the volume of the thin shell only.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/640/1*f85wYocXtt_Oz5v4xA08tw.png"><figcaption>Ratio (inner volume / total volume) as n increases (Image by the author)</figcaption></figure> <p>As we can see, it converges very quickly to 0: almost all the volume is near the surface in high dimensional spaces. For instance, for R = 1, dR = 0.05, and n = 50, about 92.3% of the volume is concentrated in the thin shell. This shows that in higher dimensions, the volume is in “corners”. This is again related to the distortion of the concept of distance we have seen earlier.</p> <p>Note that the volume of the unit hypercube (here, denoting a cube centered at zero with a side length of 2) is 2ⁿ. The unit sphere is basically “empty” in very high dimensions, while the unit hypercube, in contrast, gets exponentially more points. Again, this shows how the idea of a “nearest neighbor” of a point loses its effectiveness because there is almost no point within a distance R of a query point q when n is large.</p> <h3>Curse of dimensionality, overfitting, and Occam’s Razor</h3> <p>The curse of dimensionality is closely related to the overfitting principle. Because of the exponential growth of the volume of the space with the dimension, we need very large datasets to adequately capture and model high-dimensional patterns. Even worse: we need a number of samples that grows <strong>exponentially</strong> with the dimension to overcome this limitation. This scenario, characterized by many features yet relatively few data points, is particularly <strong>prone to overfitting</strong>.</p> <p>Occam’s Razor suggests that <strong>simpler models are generally better than complex ones</strong> because they are less likely to overfit. This principle is particularly relevant in high-dimensional contexts (where the curse of dimensionality plays a role) because it encourages the reduction of model complexity.</p> <p>Applying Occam’s Razor principle in high-dimensional scenarios can mean reducing the dimensionality of the problem itself (via methods like PCA, feature selection, etc.), thereby <strong>mitigating some effects of the curse of dimensionality</strong>. Simplifying the model’s structure or the feature space helps in managing the sparse data distribution and in making distance metrics more meaningful again. For instance, dimensionality reduction is a very common <strong>preliminary step</strong> before applying the kNN algorithm. More recent methods, such as <strong>ANNs</strong> (Approximate Nearest Neighbors) also emerge as a way to deal with high-dimensional scenarios.</p> <h3>Blessing of dimensionality?</h3> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*5hnyu5VwJ1JqdfoTqYgoFQ.png"><figcaption>Image by Dall-E</figcaption></figure> <p>While we’ve outlined the challenges of high-dimensional settings in machine learning, there are also <strong>some advantages</strong>!</p> <ul> <li>High dimensions can enhance <strong>linear separability</strong>, making techniques like kernel methods more effective.</li> <li>Additionally, deep learning architectures are <strong>particularly adept</strong> at navigating and extracting complex patterns from high-dimensional spaces.</li> </ul> <p>As always with Machine Learning, <strong>this is a trade-off</strong>: leveraging these advantages involves balancing the increased computational demands with potential gains in model performance.</p> <h3>Conclusion</h3> <p>Hopefully, this gives you an idea of how “weird” geometry can be in high-dimension and the many challenges it poses for machine learning model development. We saw how, in high-dimensional spaces, data is very sparse but also tends to be concentrated in the corners, and distances lose their usefulness. For a deeper dive into the n-ball and mathematical proofs, I encourage you to visit <a href="https://www.maximewolf.com/blog/2024/The-Volume-of-the-nball/">the extended of this article on my website</a>.</p> <p>While the “curse of dimensionality” outlines significant limitations in high-dimensional spaces, it’s exciting to see how modern deep learning models are increasingly adept at navigating these complexities. Consider the embedding models or the latest LLMs, for example, which utilize very high-dimensional vectors to more effectively discern and model textual patterns.</p> <p>Want to learn more about Transformers and how they transform your data under the hood? Check out my previous article:</p> <p><a href="https://medium.com/towards-data-science/transformers-how-do-they-transform-your-data-72d69e383e0d" rel="external nofollow noopener" target="_blank">Transformers: How Do They Transform Your Data?</a></p> <ul> <li>Feel free to connect on <a href="https://www.linkedin.com/in/maxime-wolf/" rel="external nofollow noopener" target="_blank">LinkedIn</a> </li> <li>Follow me on <a href="https://github.com/maxime7770" rel="external nofollow noopener" target="_blank">GitHub</a> for more content</li> <li>Visit my website: <a href="http://maximewolf.com" rel="external nofollow noopener" target="_blank">maximewolf.com</a> </li> </ul> <p>References:</p> <ul> <li>[1] “Volume of an n-ball.” Wikipedia, <a href="https://en.wikipedia.org/wiki/Volume_of_an_n-ball" rel="external nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/Volume_of_an_n-ball</a> </li> <li>[2] “Curse of Dimensionality.” Wikipedia, <a href="https://en.wikipedia.org/wiki/Curse_of_dimensionality#Blessing_of_dimensionality" rel="external nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/Curse_of_dimensionality#Blessing_of_dimensionality</a> </li> <li>[3] Peterson, Ivars. “An Adventure in the Nth Dimension.” American Scientist, <a href="https://www.americanscientist.org/article/an-adventure-in-the-nth-dimension" rel="external nofollow noopener" target="_blank">https://www.americanscientist.org/article/an-adventure-in-the-nth-dimension</a> </li> <li>[4] Zhang, Yuxi. “Curse of Dimensionality.” Geek Culture on Medium, July 2021, <a href="https://medium.com/geekculture/curse-of-dimensionality-e97ba916cb8f" rel="external nofollow noopener" target="_blank">https://medium.com/geekculture/curse-of-dimensionality-e97ba916cb8f</a> </li> <li>[5] “Approximate Nearest Neighbors (ANN).” Activeloop, <a href="https://www.activeloop.ai/resources/glossary/approximate-nearest-neighbors-ann/" rel="external nofollow noopener" target="_blank">https://www.activeloop.ai/resources/glossary/approximate-nearest-neighbors-ann/</a> </li> </ul> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=cf8780307d74" width="1" height="1" alt="">&lt;hr&gt;&lt;p&gt;<a href="https://medium.com/data-science/the-math-behind-the-curse-of-dimensionality-cf8780307d74" rel="external nofollow noopener" target="_blank">The Math Behind “The Curse of Dimensionality”</a> was originally published in <a href="https://medium.com/data-science" rel="external nofollow noopener" target="_blank">TDS Archive</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;</p> </body></html>